"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t=require("react"),r=e(t),n=require("@react-three/fiber"),o=e(require("zustand")),i=require("react-dom"),s=require("three");function a(){return(a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function c(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)t.indexOf(r=i[n])>=0||(o[r]=e[r]);return o}var u=o((function(e){return{message:"",a11yScreenReader:function(t){e((function(){return{message:t}}))}}})),d=r.createContext(t.createRef());d.displayName="A11ySectionContext";var l=new s.Vector3,f=new s.Vector3,p=new s.Vector3;function m(e,t,r){var n=l.setFromMatrixPosition(e.matrixWorld);n.project(t);var o=r.width/2,i=r.height/2;return[n.x*o+o,-n.y*i+i]}var h=t.forwardRef((function(e,r){var o,u=e.children,d=e.eps,h=void 0===d?.001:d,v=e.style,y=e.className,g=e.portal,b=e.zIndexRange,x=void 0===b?[16777271,0]:b,E=c(e,["children","eps","style","className","portal","zIndexRange"]),w=n.useThree((function(e){return e.gl})),k=n.useThree((function(e){return e.camera})),S=n.useThree((function(e){return e.scene})),M=n.useThree((function(e){return e.size})),P=t.useState((function(){return document.createElement("div")}))[0],R=t.useRef(null),C=t.useRef(0),O=t.useRef([0,0]),A=null!=(o=null==g?void 0:g.current)?o:w.domElement.parentNode;t.useEffect((function(){if(R.current){S.updateMatrixWorld();var e=m(R.current,k,M);return P.style.cssText="position:absolute;top:0;left:0;transform:translate3d("+e[0]+"px,"+e[1]+"px,0);transform-origin:0 0;",A&&A.appendChild(P),function(){A&&A.removeChild(P),i.unmountComponentAtNode(P)}}}),[A]);var T=t.useMemo((function(){return a({position:"absolute",transform:"none"},v)}),[v,M]);return t.useLayoutEffect((function(){i.render(t.createElement("div",{ref:r,style:T,className:y,children:u}),P)})),n.useFrame((function(){if(R.current){k.updateMatrixWorld();var e=m(R.current,k,M);(Math.abs(C.current-k.zoom)>h||Math.abs(O.current[0]-e[0])>h||Math.abs(O.current[1]-e[1])>h)&&(P.style.display=function(e,t){var r=l.setFromMatrixPosition(e.matrixWorld),n=f.setFromMatrixPosition(t.matrixWorld),o=r.sub(n),i=t.getWorldDirection(p);return o.angleTo(i)>Math.PI/2}(R.current,k)?"none":"block",P.style.zIndex=""+function(e,t,r){if(t instanceof s.PerspectiveCamera||t instanceof s.OrthographicCamera){var n=l.setFromMatrixPosition(e.matrixWorld),o=f.setFromMatrixPosition(t.matrixWorld),i=n.distanceTo(o),a=(r[1]-r[0])/(t.far-t.near);return Math.round(a*i+(r[1]-a*t.far))}}(R.current,k,x),P.style.transform="translate3d("+e[0]+"px,"+e[1]+"px,0) scale(1)",O.current=e,C.current=k.zoom)}})),t.createElement("group",Object.assign({},E,{ref:R}))})),v=r.createContext({focus:!1,hover:!1,pressed:!1});v.displayName="A11yContext";var y=r.createContext({a11yPrefersState:{prefersReducedMotion:!1,prefersDarkScheme:!1},setA11yPrefersState:function(e){}});y.displayName="A11yUserPreferencesContext";var g=function(){return t.useContext(y)},b={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",whiteSpace:"nowrap",padding:0,width:"1px",position:"absolute"};exports.A11y=function(e){var o=e.children,i=e.description,s=e.activationMsg,a=e.deactivationMsg,l=e.tabIndex,f=e.href,p=e.role,m=e.showAltText,y=void 0!==m&&m,g=e.actionCall,b=e.focusCall,x=e.disabled,E=e.debug,w=void 0!==E&&E,k=e.a11yElStyle,S=e.startPressed,M=void 0!==S&&S,P=e.hidden,R=void 0!==P&&P,C=c(e,["children","description","activationMsg","deactivationMsg","tabIndex","href","role","showAltText","actionCall","focusCall","disabled","debug","a11yElStyle","startPressed","hidden"]),O=Object.assign({opacity:w?1:0,borderRadius:"50%",width:"50px",height:"50px",overflow:"hidden",transform:"translateX(-50%) translateY(-50%)",display:"inline-block",userSelect:"none",WebkitUserSelect:"none",WebkitTouchCallout:"none",margin:0},k),A=t.useState({hovered:!1,focused:!1,pressed:M||!1}),T=A[0],j=A[1],D=u((function(e){return e.a11yScreenReader})),F=t.useRef(!1),L=t.useRef(!1),I=n.useThree((function(e){return e.gl.domElement})),N=t.useRef(!0);t.useEffect((function(){return function(){I.style.cursor="default",N.current=!1}}),[]),r.Children.only(o);var W=function(e){e.eventObject?L.current=!0:F.current=!0,(F.current||L.current)&&("content"===p||x||(I.style.cursor="pointer"),j({hovered:!0,focused:T.focused,pressed:T.pressed}))},q=function(e){e.eventObject?L.current=!1:F.current=!1,F.current||L.current||N.current&&(I.style.cursor="default",j({hovered:!1,focused:T.focused,pressed:T.pressed}))};function z(){D(""),window.setTimeout((function(){"string"==typeof s&&D(s)}),100),"function"==typeof g&&g()}function B(){T.pressed?"string"==typeof a&&D(a):"string"==typeof s&&D(s),j({hovered:T.hovered,focused:T.focused,pressed:!T.pressed}),"function"==typeof g&&g()}var U=r.useMemo((function(){return"button"===p||"togglebutton"===p?r.createElement("button",Object.assign({"r3f-a11y":"true"},x?{disabled:!0}:null,"togglebutton"===p?{"aria-pressed":T.pressed?"true":"false",tabIndex:l||0,style:Object.assign(O,x?{cursor:"default"}:{cursor:"pointer"},R?{visibility:"hidden"}:{visibility:"visible"}),onPointerOver:W,onPointerOut:q,onClick:function(e){e.stopPropagation(),x||B()},onFocus:function(){"function"==typeof b&&b(),j({hovered:T.hovered,focused:!0,pressed:T.pressed})},onBlur:function(){j({hovered:T.hovered,focused:!1,pressed:T.pressed})}}:{tabIndex:l||0,style:Object.assign(O,x?{cursor:"default"}:{cursor:"pointer"},R?{visibility:"hidden"}:{visibility:"visible"}),onPointerOver:W,onPointerOut:q,onClick:function(e){e.stopPropagation(),x||z()},onFocus:function(){"function"==typeof b&&b(),j({hovered:T.hovered,focused:!0,pressed:T.pressed})},onBlur:function(){j({hovered:T.hovered,focused:!1,pressed:T.pressed})}}),i):"link"===p?r.createElement("a",{"r3f-a11y":"true",style:Object.assign(O,R?{visibility:"hidden"}:{visibility:"visible"}),href:f,onPointerOver:W,onPointerOut:q,onClick:function(e){e.stopPropagation(),e.preventDefault(),"function"==typeof g&&g()},onFocus:function(){"function"==typeof b&&b(),j({hovered:T.hovered,focused:!0,pressed:T.pressed})},onBlur:function(){j({hovered:T.hovered,focused:!1,pressed:T.pressed})}},i):r.createElement("p",Object.assign({"r3f-a11y":"true"},l?{tabIndex:l}:null,{style:Object.assign(O,R?{visibility:"hidden"}:{visibility:"visible"}),onPointerOver:W,onPointerOut:q,onBlur:function(){j({hovered:T.hovered,focused:!1,pressed:T.pressed})},onFocus:function(){"function"==typeof b&&b(),j({hovered:T.hovered,focused:!0,pressed:T.pressed})}}),i)}),[i,T,R,l,f,x,M,g,b]),H=null;y&&T.hovered&&(H=r.createElement("div",{"aria-hidden":!0,style:{width:"auto",maxWidth:"300px",display:"block",position:"absolute",top:"0px",left:"0px",transform:"translate(-50%,-50%)",background:"white",borderRadius:"4px",padding:"4px"}},r.createElement("p",{"aria-hidden":!0,style:{margin:"0px"}},i)));var V=t.useContext(d),_={};return V instanceof HTMLElement&&(_={portal:V}),r.createElement(v.Provider,{value:{hover:T.hovered,focus:T.focused,pressed:T.pressed}},r.createElement("group",Object.assign({},C,{onClick:function(e){e.stopPropagation(),x||("button"===p?z():"togglebutton"===p?B():"function"==typeof g&&g())},onPointerOver:W,onPointerOut:q}),o,r.createElement(h,Object.assign({style:{width:"0px"},position:o.props.position?o.props.position:0},_),H,U)))},exports.A11yAnnouncer=function(){var e=u((function(e){return e.message}));return t.useEffect((function(){var e=function(e){var t;null!=(t=window.document.activeElement)&&t.getAttribute("r3f-a11y")&&0!==e.detail&&window.document.activeElement instanceof HTMLElement&&window.document.activeElement.blur()};return window.addEventListener("click",e),function(){window.removeEventListener("click",e)}})),r.createElement("div",{style:b,"aria-atomic":"true","aria-live":"polite"},e)},exports.A11yDebuger=function(e){!function(e){if(null==e)throw new TypeError("Cannot destructure undefined")}(e);var n=t.useState((function(){return document.createElement("div")}))[0],o=t.useState({}),s=o[0],a=o[1],c=t.useState({prefersDarkScheme:!1,prefersReducedMotion:!1}),u=c[0],d=c[1],l=g(),f=l.a11yPrefersState,p=l.setA11yPrefersState,m=t.useRef(null);t.useEffect((function(){n.style.cssText="position:fixed;top:0;left:0;",n.setAttribute("aria-hidden","true"),document.body.appendChild(n),d({prefersDarkScheme:f.prefersDarkScheme,prefersReducedMotion:f.prefersReducedMotion});var e=function(){var e;console.log("focused: ",document.activeElement);var t=null==(e=document.activeElement)?void 0:e.getAttribute("r3f-a11y-debug-id");if(t){document.querySelectorAll("[r3fa11ydebugidref]").forEach((function(e){e.style.color=null}));var r=document.querySelector('[r3fa11ydebugidref="'+t+'"]');r&&(r.style.color="red")}};console.log("enregistre ev"),document.addEventListener("focus",e,!0);var t=window.setInterval((function(){var e=0,t=[];document.querySelectorAll("[r3f-a11y]").forEach((function(n){n.setAttribute("r3f-a11y-debug-id",""+e),t.push(r.createElement("li",{key:e,r3fa11ydebugidref:e},n.tagName,r.createElement("button",{tabIndex:-1,onClick:function(){console.log(n);var e=n.getBoundingClientRect();a({width:e.width,height:e.height,top:e.top,left:e.left})}},"Show"))),e++})),i.render(r.createElement(r.Fragment,null,t),m.current)}),2e3);return function(){clearInterval(t),i.unmountComponentAtNode(n),console.log("remove ev"),document.removeEventListener("focus",e,!0)}}),[f]);var h=function(e){p({prefersDarkScheme:"prefersDarkScheme"===e.target.name?e.target.checked:u.prefersDarkScheme,prefersReducedMotion:"prefersReducedMotion"===e.target.name?e.target.checked:u.prefersReducedMotion})};return t.useLayoutEffect((function(){i.render(r.createElement(r.Fragment,null,r.createElement("label",null,"Prefer dark mode",r.createElement("input",{type:"checkbox",name:"prefersDarkScheme",checked:u.prefersDarkScheme,onChange:h})),r.createElement("label",null,"Prefer reduced motion",r.createElement("input",{type:"checkbox",name:"prefersReducedMotion",checked:u.prefersReducedMotion,onChange:h})),r.createElement("h3",null,"R3F Dom order"),r.createElement("ul",{ref:m}),r.createElement("div",{style:Object.assign({position:"absolute",border:"1px solid white",borderRadius:"50%",background:"linear-gradient( 45deg, rgb(70, 255, 60, 0.7), rgb(0, 64, 193, 0.7))",pointerEvents:"none",transition:"all 200ms ease"},s)})),n)})),r.createElement(r.Fragment,null)},exports.A11ySection=function(e){var o=e.children,i=e.label,s=e.description,a=t.useRef(null),c=t.useRef(null),u=n.useThree((function(e){return e.gl})),l=r.useState((function(){return document.createElement("section")}))[0],f=u.domElement.parentNode;return t.useEffect((function(){if(i&&l.setAttribute("aria-label",i),l.setAttribute("r3f-a11y","true"),s)if(null===c.current){var e=document.createElement("p");e.innerHTML=s,e.style.cssText="border: 0!important;clip: rect(1px,1px,1px,1px)!important;-webkit-clip-path: inset(50%)!important;clip-path: inset(50%)!important;height: 1px!important;margin: -1px!important;overflow: hidden!important;padding: 0!important;position: absolute!important;width: 1px!important;white-space: nowrap!important;",l.prepend(e),c.current=e}else c.current.innerHTML=s;return function(){f&&f.removeChild(l)}}),[s,i]),null===a.current&&(f&&f.appendChild(l),a.current=l),r.createElement(r.Fragment,null,r.createElement(d.Provider,{value:a},o))},exports.A11yUserPreferences=function(e){var n=e.children,o=t.useState({prefersReducedMotion:!1,prefersDarkScheme:!1}),i=o[0],s=o[1];return t.useEffect((function(){var e=window.matchMedia("(prefers-reduced-motion: reduce)"),t=window.matchMedia("(prefers-color-scheme: dark)");s({prefersReducedMotion:e.matches,prefersDarkScheme:t.matches});var r=function(e){s({prefersReducedMotion:e.matches,prefersDarkScheme:t.matches})},n=function(t){s({prefersReducedMotion:e.matches,prefersDarkScheme:t.matches})};return e.addEventListener("change",r),t.addEventListener("change",n),function(){e.removeEventListener("change",r),t.removeEventListener("change",n)}}),[]),r.createElement(y.Provider,{value:{a11yPrefersState:{prefersReducedMotion:i.prefersReducedMotion,prefersDarkScheme:i.prefersDarkScheme},setA11yPrefersState:s}},n)},exports.A11yUserPreferencesContext=y,exports.useA11y=function(){return t.useContext(v)},exports.useUserPreferences=g;
//# sourceMappingURL=a11y.cjs.production.min.js.map
