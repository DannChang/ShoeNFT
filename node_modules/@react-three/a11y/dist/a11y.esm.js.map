{"version":3,"file":"a11y.esm.js","sources":["../src/announceStore.tsx","../src/A11ySection.tsx","../src/Html.tsx","../src/A11y.tsx","../src/A11yUserPreferences.tsx","../src/A11yAnnouncer.tsx","../src/A11yDebuger.tsx"],"sourcesContent":["import create from 'zustand';\r\n\r\ntype State = {\r\n  message: string;\r\n  a11yScreenReader: (message: string) => void;\r\n};\r\n\r\nconst useAnnounceStore = create<State>(set => {\r\n  return {\r\n    message: '',\r\n    a11yScreenReader: message => {\r\n      set(() => {\r\n        return { message: message };\r\n      });\r\n    },\r\n  };\r\n});\r\n\r\nexport default useAnnounceStore;\r\n","import React, {\r\n  useContext,\r\n  useEffect,\r\n  useRef,\r\n  MutableRefObject,\r\n  createRef,\r\n} from 'react';\r\nimport { useThree } from '@react-three/fiber';\r\n\r\ninterface Props {\r\n  children: React.ReactNode;\r\n  label: string;\r\n  description: string;\r\n}\r\n\r\nconst A11ySectionContext = React.createContext<\r\n  MutableRefObject<HTMLElement | null>\r\n>(createRef());\r\n\r\nA11ySectionContext.displayName = 'A11ySectionContext';\r\n\r\nconst useA11ySectionContext = () => {\r\n  return useContext(A11ySectionContext);\r\n};\r\n\r\nexport { useA11ySectionContext };\r\n\r\nexport const A11ySection: React.FC<Props> = ({\r\n  children,\r\n  label,\r\n  description,\r\n}) => {\r\n  const ref = useRef<HTMLElement | null>(null);\r\n  const refpDesc = useRef<HTMLParagraphElement | null>(null);\r\n  const gl = useThree(state => state.gl);\r\n  const [el] = React.useState(() => document.createElement('section'));\r\n  const target = gl.domElement.parentNode;\r\n\r\n  useEffect(() => {\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    if (label) {\r\n      el.setAttribute('aria-label', label);\r\n    }\r\n    el.setAttribute('r3f-a11y', 'true');\r\n    if (description) {\r\n      if (refpDesc.current === null) {\r\n        const pDesc = document.createElement('p');\r\n        pDesc.innerHTML = description;\r\n        pDesc.style.cssText =\r\n          'border: 0!important;clip: rect(1px,1px,1px,1px)!important;-webkit-clip-path: inset(50%)!important;clip-path: inset(50%)!important;height: 1px!important;margin: -1px!important;overflow: hidden!important;padding: 0!important;position: absolute!important;width: 1px!important;white-space: nowrap!important;';\r\n        el.prepend(pDesc);\r\n        refpDesc.current = pDesc;\r\n      } else {\r\n        refpDesc.current.innerHTML = description;\r\n      }\r\n    }\r\n    return () => {\r\n      if (target) target.removeChild(el);\r\n    };\r\n  }, [description, label]);\r\n\r\n  if (ref.current === null) {\r\n    if (target) {\r\n      target.appendChild(el);\r\n    }\r\n    ref.current = el;\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <A11ySectionContext.Provider value={ref}>\r\n        {children}\r\n      </A11ySectionContext.Provider>\r\n    </>\r\n  );\r\n};\r\n","//https://raw.githubusercontent.com/pmndrs/drei/master/src/web/Html.tsx\r\nimport * as React from 'react';\r\nimport * as ReactDOM from 'react-dom';\r\nimport {\r\n  Vector3,\r\n  Group,\r\n  Object3D,\r\n  Camera,\r\n  PerspectiveCamera,\r\n  OrthographicCamera,\r\n} from 'three';\r\nimport { Assign } from 'utility-types';\r\nimport { ReactThreeFiber, useFrame, useThree } from '@react-three/fiber';\r\n\r\nconst v1 = new Vector3();\r\nconst v2 = new Vector3();\r\nconst v3 = new Vector3();\r\n\r\nfunction calculatePosition(\r\n  el: Object3D,\r\n  camera: Camera,\r\n  size: { width: number; height: number }\r\n) {\r\n  const objectPos = v1.setFromMatrixPosition(el.matrixWorld);\r\n  objectPos.project(camera);\r\n  const widthHalf = size.width / 2;\r\n  const heightHalf = size.height / 2;\r\n  return [\r\n    objectPos.x * widthHalf + widthHalf,\r\n    -(objectPos.y * heightHalf) + heightHalf,\r\n  ];\r\n}\r\n\r\nfunction isObjectBehindCamera(el: Object3D, camera: Camera) {\r\n  const objectPos = v1.setFromMatrixPosition(el.matrixWorld);\r\n  const cameraPos = v2.setFromMatrixPosition(camera.matrixWorld);\r\n  const deltaCamObj = objectPos.sub(cameraPos);\r\n  const camDir = camera.getWorldDirection(v3);\r\n  return deltaCamObj.angleTo(camDir) > Math.PI / 2;\r\n}\r\n\r\nfunction objectZIndex(\r\n  el: Object3D,\r\n  camera: Camera,\r\n  zIndexRange: Array<number>\r\n) {\r\n  if (\r\n    camera instanceof PerspectiveCamera ||\r\n    camera instanceof OrthographicCamera\r\n  ) {\r\n    const objectPos = v1.setFromMatrixPosition(el.matrixWorld);\r\n    const cameraPos = v2.setFromMatrixPosition(camera.matrixWorld);\r\n    const dist = objectPos.distanceTo(cameraPos);\r\n    const A = (zIndexRange[1] - zIndexRange[0]) / (camera.far - camera.near);\r\n    const B = zIndexRange[1] - A * camera.far;\r\n    return Math.round(A * dist + B);\r\n  }\r\n  return undefined;\r\n}\r\n\r\nexport interface HtmlProps\r\n  extends Omit<\r\n    Assign<\r\n      React.HTMLAttributes<HTMLDivElement>,\r\n      ReactThreeFiber.Object3DNode<Group, typeof Group>\r\n    >,\r\n    'ref'\r\n  > {\r\n  eps?: number;\r\n  portal?: React.MutableRefObject<HTMLElement>;\r\n  zIndexRange?: Array<number>;\r\n}\r\n\r\nexport const Html = React.forwardRef(\r\n  (\r\n    {\r\n      children,\r\n      eps = 0.001,\r\n      style,\r\n      className,\r\n      portal,\r\n      zIndexRange = [16777271, 0],\r\n      ...props\r\n    }: HtmlProps,\r\n    ref: React.Ref<HTMLDivElement>\r\n  ) => {\r\n    const gl = useThree(({ gl }) => gl);\r\n    const camera = useThree(({ camera }) => camera);\r\n    const scene = useThree(({ scene }) => scene);\r\n    const size = useThree(({ size }) => size);\r\n    const [el] = React.useState(() => document.createElement('div'));\r\n    const group = React.useRef<Group>(null);\r\n    const oldZoom = React.useRef(0);\r\n    const oldPosition = React.useRef([0, 0]);\r\n    const target = portal?.current ?? gl.domElement.parentNode;\r\n\r\n    React.useEffect(() => {\r\n      if (group.current) {\r\n        scene.updateMatrixWorld();\r\n        const vec = calculatePosition(group.current, camera, size);\r\n        el.style.cssText = `position:absolute;top:0;left:0;transform:translate3d(${vec[0]}px,${vec[1]}px,0);transform-origin:0 0;`;\r\n        if (target) {\r\n          target.appendChild(el);\r\n        }\r\n        return () => {\r\n          if (target) target.removeChild(el);\r\n          ReactDOM.unmountComponentAtNode(el);\r\n        };\r\n      }\r\n      // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [target]);\r\n\r\n    const styles: React.CSSProperties = React.useMemo(() => {\r\n      return {\r\n        position: 'absolute',\r\n        transform: 'none',\r\n        ...style,\r\n      };\r\n    }, [style, size]);\r\n\r\n    React.useLayoutEffect(() => {\r\n      ReactDOM.render(\r\n        <div\r\n          ref={ref}\r\n          style={styles}\r\n          className={className}\r\n          children={children}\r\n        />,\r\n        el\r\n      );\r\n    });\r\n\r\n    useFrame(() => {\r\n      if (group.current) {\r\n        camera.updateMatrixWorld();\r\n        const vec = calculatePosition(group.current, camera, size);\r\n\r\n        if (\r\n          Math.abs(oldZoom.current - camera.zoom) > eps ||\r\n          Math.abs(oldPosition.current[0] - vec[0]) > eps ||\r\n          Math.abs(oldPosition.current[1] - vec[1]) > eps\r\n        ) {\r\n          el.style.display = !isObjectBehindCamera(group.current, camera)\r\n            ? 'block'\r\n            : 'none';\r\n          el.style.zIndex = `${objectZIndex(\r\n            group.current,\r\n            camera,\r\n            zIndexRange\r\n          )}`;\r\n          el.style.transform = `translate3d(${vec[0]}px,${vec[1]}px,0) scale(1)`;\r\n          oldPosition.current = vec;\r\n          oldZoom.current = camera.zoom;\r\n        }\r\n      }\r\n    });\r\n\r\n    return <group {...props} ref={group} />;\r\n  }\r\n);\r\n","import React, { useEffect, useRef, useState, useContext } from 'react';\r\nimport { useThree } from '@react-three/fiber';\r\nimport useAnnounceStore from './announceStore';\r\nimport { useA11ySectionContext } from './A11ySection';\r\nimport { Html } from './Html';\r\n\r\ninterface A11yCommonProps {\r\n  role: 'button' | 'togglebutton' | 'link' | 'content';\r\n  children: React.ReactNode;\r\n  description: string;\r\n  tabIndex?: number;\r\n  showAltText?: boolean;\r\n  focusCall?: (...args: any[]) => any;\r\n  debug?: boolean;\r\n  a11yElStyle?: Object;\r\n  hidden?: boolean;\r\n}\r\n\r\ntype RoleProps =\r\n  | {\r\n      role: 'content';\r\n      activationMsg?: never;\r\n      deactivationMsg?: never;\r\n      actionCall?: never;\r\n      href?: never;\r\n      disabled?: never;\r\n      startPressed?: never;\r\n    }\r\n  | {\r\n      role: 'button';\r\n      activationMsg?: string;\r\n      deactivationMsg?: never;\r\n      actionCall?: () => any;\r\n      href?: never;\r\n      disabled?: boolean;\r\n      startPressed?: never;\r\n    }\r\n  | {\r\n      role: 'togglebutton';\r\n      activationMsg?: string;\r\n      deactivationMsg?: string;\r\n      actionCall?: () => any;\r\n      href?: never;\r\n      disabled?: boolean;\r\n      startPressed?: boolean;\r\n    }\r\n  | {\r\n      role: 'link';\r\n      activationMsg?: never;\r\n      deactivationMsg?: never;\r\n      actionCall: () => any;\r\n      href: string;\r\n      disabled?: never;\r\n      startPressed?: never;\r\n    };\r\n\r\ntype Props = A11yCommonProps & RoleProps;\r\n\r\nconst A11yContext = React.createContext({\r\n  focus: false,\r\n  hover: false,\r\n  pressed: false,\r\n});\r\n\r\nA11yContext.displayName = 'A11yContext';\r\n\r\nconst useA11y = () => {\r\n  return useContext(A11yContext);\r\n};\r\n\r\nexport { useA11y };\r\n\r\nexport const A11y: React.FC<Props> = ({\r\n  children,\r\n  description,\r\n  activationMsg,\r\n  deactivationMsg,\r\n  tabIndex,\r\n  href,\r\n  role,\r\n  showAltText = false,\r\n  actionCall,\r\n  focusCall,\r\n  disabled,\r\n  debug = false,\r\n  a11yElStyle,\r\n  startPressed = false,\r\n  hidden = false,\r\n  ...props\r\n}) => {\r\n  let constHiddenButScreenreadable = Object.assign(\r\n    {\r\n      opacity: debug ? 1 : 0,\r\n      borderRadius: '50%',\r\n      width: '50px',\r\n      height: '50px',\r\n      overflow: 'hidden',\r\n      transform: 'translateX(-50%) translateY(-50%)',\r\n      display: 'inline-block',\r\n      userSelect: 'none' as const,\r\n      WebkitUserSelect: 'none' as const,\r\n      WebkitTouchCallout: 'none' as const,\r\n      margin: 0,\r\n    },\r\n    a11yElStyle\r\n  );\r\n\r\n  const [a11yState, setA11yState] = useState({\r\n    hovered: false,\r\n    focused: false,\r\n    pressed: startPressed ? startPressed : false,\r\n  });\r\n\r\n  const a11yScreenReader = useAnnounceStore(state => state.a11yScreenReader);\r\n\r\n  const overHtml = useRef(false);\r\n  const overMesh = useRef(false);\r\n\r\n  const domElement = useThree(state => state.gl.domElement);\r\n\r\n  // temporary fix to prevent error -> keep track of our component's mounted state\r\n  const componentIsMounted = useRef(true);\r\n  useEffect(() => {\r\n    return () => {\r\n      domElement.style.cursor = 'default';\r\n      componentIsMounted.current = false;\r\n    };\r\n  }, []); // Using an empty dependency array ensures this on\r\n\r\n  React.Children.only(children);\r\n  // @ts-ignore\r\n  const handleOnPointerOver = e => {\r\n    if (e.eventObject) {\r\n      overMesh.current = true;\r\n    } else {\r\n      overHtml.current = true;\r\n    }\r\n    if (overHtml.current || overMesh.current) {\r\n      if (role !== 'content' && !disabled) {\r\n        domElement.style.cursor = 'pointer';\r\n      }\r\n      setA11yState({\r\n        hovered: true,\r\n        focused: a11yState.focused,\r\n        pressed: a11yState.pressed,\r\n      });\r\n    }\r\n  };\r\n  // @ts-ignore\r\n  const handleOnPointerOut = e => {\r\n    if (e.eventObject) {\r\n      overMesh.current = false;\r\n    } else {\r\n      overHtml.current = false;\r\n    }\r\n    if (!overHtml.current && !overMesh.current) {\r\n      if (componentIsMounted.current) {\r\n        domElement.style.cursor = 'default';\r\n        setA11yState({\r\n          hovered: false,\r\n          focused: a11yState.focused,\r\n          pressed: a11yState.pressed,\r\n        });\r\n      }\r\n    }\r\n  };\r\n\r\n  function handleBtnClick() {\r\n    //msg is the same need to be clean for it to trigger again in case of multiple press in a row\r\n    a11yScreenReader('');\r\n    window.setTimeout(() => {\r\n      if (typeof activationMsg === 'string') a11yScreenReader(activationMsg);\r\n    }, 100);\r\n    if (typeof actionCall === 'function') actionCall();\r\n  }\r\n\r\n  function handleToggleBtnClick() {\r\n    if (a11yState.pressed) {\r\n      if (typeof deactivationMsg === 'string')\r\n        a11yScreenReader(deactivationMsg);\r\n    } else {\r\n      if (typeof activationMsg === 'string') a11yScreenReader(activationMsg);\r\n    }\r\n    setA11yState({\r\n      hovered: a11yState.hovered,\r\n      focused: a11yState.focused,\r\n      pressed: !a11yState.pressed,\r\n    });\r\n    if (typeof actionCall === 'function') actionCall();\r\n  }\r\n\r\n  const returnHtmlA11yEl = () => {\r\n    if (role === 'button' || role === 'togglebutton') {\r\n      let disabledBtnAttr = disabled\r\n        ? {\r\n            disabled: true,\r\n          }\r\n        : null;\r\n      if (role === 'togglebutton') {\r\n        return (\r\n          <button\r\n            r3f-a11y=\"true\"\r\n            {...disabledBtnAttr}\r\n            aria-pressed={a11yState.pressed ? 'true' : 'false'}\r\n            tabIndex={tabIndex ? tabIndex : 0}\r\n            style={Object.assign(\r\n              constHiddenButScreenreadable,\r\n              disabled ? { cursor: 'default' } : { cursor: 'pointer' },\r\n              hidden\r\n                ? { visibility: 'hidden' as const }\r\n                : { visibility: 'visible' as const }\r\n            )}\r\n            onPointerOver={handleOnPointerOver}\r\n            onPointerOut={handleOnPointerOut}\r\n            onClick={e => {\r\n              e.stopPropagation();\r\n              if (disabled) {\r\n                return;\r\n              }\r\n              handleToggleBtnClick();\r\n            }}\r\n            onFocus={() => {\r\n              if (typeof focusCall === 'function') focusCall();\r\n              setA11yState({\r\n                hovered: a11yState.hovered,\r\n                focused: true,\r\n                pressed: a11yState.pressed,\r\n              });\r\n            }}\r\n            onBlur={() => {\r\n              setA11yState({\r\n                hovered: a11yState.hovered,\r\n                focused: false,\r\n                pressed: a11yState.pressed,\r\n              });\r\n            }}\r\n          >\r\n            {description}\r\n          </button>\r\n        );\r\n      } else {\r\n        //regular btn\r\n        return (\r\n          <button\r\n            r3f-a11y=\"true\"\r\n            {...disabledBtnAttr}\r\n            tabIndex={tabIndex ? tabIndex : 0}\r\n            style={Object.assign(\r\n              constHiddenButScreenreadable,\r\n              disabled ? { cursor: 'default' } : { cursor: 'pointer' },\r\n              hidden\r\n                ? { visibility: 'hidden' as const }\r\n                : { visibility: 'visible' as const }\r\n            )}\r\n            onPointerOver={handleOnPointerOver}\r\n            onPointerOut={handleOnPointerOut}\r\n            onClick={e => {\r\n              e.stopPropagation();\r\n              if (disabled) {\r\n                return;\r\n              }\r\n              handleBtnClick();\r\n            }}\r\n            onFocus={() => {\r\n              if (typeof focusCall === 'function') focusCall();\r\n              setA11yState({\r\n                hovered: a11yState.hovered,\r\n                focused: true,\r\n                pressed: a11yState.pressed,\r\n              });\r\n            }}\r\n            onBlur={() => {\r\n              setA11yState({\r\n                hovered: a11yState.hovered,\r\n                focused: false,\r\n                pressed: a11yState.pressed,\r\n              });\r\n            }}\r\n          >\r\n            {description}\r\n          </button>\r\n        );\r\n      }\r\n    } else if (role === 'link') {\r\n      return (\r\n        <a\r\n          r3f-a11y=\"true\"\r\n          style={Object.assign(\r\n            constHiddenButScreenreadable,\r\n            hidden\r\n              ? { visibility: 'hidden' as const }\r\n              : { visibility: 'visible' as const }\r\n          )}\r\n          href={href}\r\n          onPointerOver={handleOnPointerOver}\r\n          onPointerOut={handleOnPointerOut}\r\n          onClick={e => {\r\n            e.stopPropagation();\r\n            e.preventDefault();\r\n            if (typeof actionCall === 'function') actionCall();\r\n          }}\r\n          onFocus={() => {\r\n            if (typeof focusCall === 'function') focusCall();\r\n            setA11yState({\r\n              hovered: a11yState.hovered,\r\n              focused: true,\r\n              pressed: a11yState.pressed,\r\n            });\r\n          }}\r\n          onBlur={() => {\r\n            setA11yState({\r\n              hovered: a11yState.hovered,\r\n              focused: false,\r\n              pressed: a11yState.pressed,\r\n            });\r\n          }}\r\n        >\r\n          {description}\r\n        </a>\r\n      );\r\n    } else {\r\n      let tabIndexP = tabIndex\r\n        ? {\r\n            tabIndex: tabIndex,\r\n          }\r\n        : null;\r\n      return (\r\n        <p\r\n          r3f-a11y=\"true\"\r\n          {...tabIndexP}\r\n          style={Object.assign(\r\n            constHiddenButScreenreadable,\r\n            hidden\r\n              ? { visibility: 'hidden' as const }\r\n              : { visibility: 'visible' as const }\r\n          )}\r\n          onPointerOver={handleOnPointerOver}\r\n          onPointerOut={handleOnPointerOut}\r\n          onBlur={() => {\r\n            setA11yState({\r\n              hovered: a11yState.hovered,\r\n              focused: false,\r\n              pressed: a11yState.pressed,\r\n            });\r\n          }}\r\n          onFocus={() => {\r\n            if (typeof focusCall === 'function') focusCall();\r\n            setA11yState({\r\n              hovered: a11yState.hovered,\r\n              focused: true,\r\n              pressed: a11yState.pressed,\r\n            });\r\n          }}\r\n        >\r\n          {description}\r\n        </p>\r\n      );\r\n    }\r\n  };\r\n\r\n  const HtmlAccessibleElement = React.useMemo(returnHtmlA11yEl, [\r\n    description,\r\n    a11yState,\r\n    hidden,\r\n    tabIndex,\r\n    href,\r\n    disabled,\r\n    startPressed,\r\n    actionCall,\r\n    focusCall,\r\n  ]);\r\n\r\n  let AltText = null;\r\n  if (showAltText && a11yState.hovered) {\r\n    AltText = (\r\n      <div\r\n        aria-hidden={true}\r\n        style={{\r\n          width: 'auto',\r\n          maxWidth: '300px',\r\n          display: 'block',\r\n          position: 'absolute',\r\n          top: '0px',\r\n          left: '0px',\r\n          transform: 'translate(-50%,-50%)',\r\n          background: 'white',\r\n          borderRadius: '4px',\r\n          padding: '4px',\r\n        }}\r\n      >\r\n        <p\r\n          aria-hidden={true}\r\n          style={{\r\n            margin: '0px',\r\n          }}\r\n        >\r\n          {description}\r\n        </p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const section = useA11ySectionContext();\r\n  let portal = {};\r\n  if (section instanceof HTMLElement) {\r\n    portal = { portal: section };\r\n  }\r\n\r\n  return (\r\n    <A11yContext.Provider\r\n      value={{\r\n        hover: a11yState.hovered,\r\n        focus: a11yState.focused,\r\n        pressed: a11yState.pressed,\r\n      }}\r\n    >\r\n      <group\r\n        {...props}\r\n        onClick={e => {\r\n          e.stopPropagation();\r\n          if (disabled) {\r\n            return;\r\n          }\r\n          if (role === 'button') {\r\n            handleBtnClick();\r\n          } else if (role === 'togglebutton') {\r\n            handleToggleBtnClick();\r\n          } else {\r\n            if (typeof actionCall === 'function') actionCall();\r\n          }\r\n        }}\r\n        onPointerOver={handleOnPointerOver}\r\n        onPointerOut={handleOnPointerOut}\r\n      >\r\n        {children}\r\n        <Html\r\n          style={{ width: '0px' }}\r\n          position={\r\n            // @ts-ignore\r\n            children.props.position ? children.props.position : 0\r\n          }\r\n          {...portal}\r\n        >\r\n          {AltText}\r\n          {HtmlAccessibleElement}\r\n        </Html>\r\n      </group>\r\n    </A11yContext.Provider>\r\n  );\r\n};\r\n","import React, { useEffect, useState, useContext } from 'react';\r\ninterface Props {\r\n  children: React.ReactNode;\r\n}\r\n\r\ntype aasetA11yPrefersState = {\r\n  prefersReducedMotion: boolean;\r\n  prefersDarkScheme: boolean;\r\n};\r\n\r\nconst A11yUserPreferencesContext = React.createContext({\r\n  a11yPrefersState: {\r\n    prefersReducedMotion: false,\r\n    prefersDarkScheme: false,\r\n  },\r\n  // tslint:disable:no-unused-variable\r\n  setA11yPrefersState: (_state: aasetA11yPrefersState) => {},\r\n  // tslint:enable:no-unused-variable\r\n});\r\n\r\nA11yUserPreferencesContext.displayName = 'A11yUserPreferencesContext';\r\n\r\nconst useUserPreferences = () => {\r\n  return useContext(A11yUserPreferencesContext);\r\n};\r\n\r\nexport { useUserPreferences, A11yUserPreferencesContext };\r\n\r\nexport const A11yUserPreferences: React.FC<Props> = ({ children }) => {\r\n  const [a11yPrefersState, setA11yPrefersState] = useState({\r\n    prefersReducedMotion: false,\r\n    prefersDarkScheme: false,\r\n  });\r\n\r\n  useEffect(() => {\r\n    const prefersReducedMotionMediaQuery = window.matchMedia(\r\n      '(prefers-reduced-motion: reduce)'\r\n    );\r\n    const prefersDarkSchemeMediaQuery = window.matchMedia(\r\n      '(prefers-color-scheme: dark)'\r\n    );\r\n\r\n    setA11yPrefersState({\r\n      prefersReducedMotion: prefersReducedMotionMediaQuery.matches,\r\n      prefersDarkScheme: prefersDarkSchemeMediaQuery.matches,\r\n    });\r\n\r\n    const handleReducedMotionPrefChange = (e: MediaQueryListEvent) => {\r\n      setA11yPrefersState({\r\n        prefersReducedMotion: e.matches,\r\n        prefersDarkScheme: prefersDarkSchemeMediaQuery.matches,\r\n      });\r\n    };\r\n    const handleDarkSchemePrefChange = (e: MediaQueryListEvent) => {\r\n      setA11yPrefersState({\r\n        prefersReducedMotion: prefersReducedMotionMediaQuery.matches,\r\n        prefersDarkScheme: e.matches,\r\n      });\r\n    };\r\n\r\n    prefersReducedMotionMediaQuery.addEventListener(\r\n      'change',\r\n      handleReducedMotionPrefChange\r\n    );\r\n    prefersDarkSchemeMediaQuery.addEventListener(\r\n      'change',\r\n      handleDarkSchemePrefChange\r\n    );\r\n    return () => {\r\n      prefersReducedMotionMediaQuery.removeEventListener(\r\n        'change',\r\n        handleReducedMotionPrefChange\r\n      );\r\n      prefersDarkSchemeMediaQuery.removeEventListener(\r\n        'change',\r\n        handleDarkSchemePrefChange\r\n      );\r\n    };\r\n  }, []);\r\n\r\n  return (\r\n    <A11yUserPreferencesContext.Provider\r\n      value={{\r\n        a11yPrefersState: {\r\n          prefersReducedMotion: a11yPrefersState.prefersReducedMotion,\r\n          prefersDarkScheme: a11yPrefersState.prefersDarkScheme,\r\n        },\r\n        setA11yPrefersState: setA11yPrefersState,\r\n      }}\r\n    >\r\n      {children}\r\n    </A11yUserPreferencesContext.Provider>\r\n  );\r\n};\r\n","import React, { useEffect } from 'react';\r\nimport useAnnounceStore from './announceStore';\r\n\r\nconst offScreenStyle = {\r\n  border: 0,\r\n  clip: 'rect(0 0 0 0)',\r\n  height: '1px',\r\n  margin: '-1px',\r\n  overflow: 'hidden',\r\n  whiteSpace: 'nowrap' as const,\r\n  padding: 0,\r\n  width: '1px',\r\n  position: 'absolute' as const,\r\n};\r\n\r\nexport const A11yAnnouncer: React.FC = () => {\r\n  const message = useAnnounceStore(state => state.message);\r\n\r\n  useEffect(() => {\r\n    const mouseClickListener = (e: MouseEvent) => {\r\n      if (\r\n        window.document.activeElement?.getAttribute('r3f-a11y') &&\r\n        e.detail !== 0\r\n      ) {\r\n        if (window.document.activeElement instanceof HTMLElement) {\r\n          window.document.activeElement.blur();\r\n        }\r\n      }\r\n    };\r\n    window.addEventListener('click', mouseClickListener);\r\n    return () => {\r\n      window.removeEventListener('click', mouseClickListener);\r\n    };\r\n  });\r\n\r\n  return (\r\n    <div style={offScreenStyle} aria-atomic=\"true\" aria-live=\"polite\">\r\n      {message}\r\n    </div>\r\n  );\r\n};\r\n","import React, { useLayoutEffect, useEffect, useState, useRef } from 'react';\r\nimport * as ReactDOM from 'react-dom';\r\nimport { useUserPreferences } from './A11yUserPreferences';\r\ninterface Props {}\r\n\r\nexport const A11yDebuger: React.FC<Props> = ({}) => {\r\n  const [el] = useState(() => document.createElement('div'));\r\n  const [boundingStyle, setBoundingStyle] = useState({});\r\n  const [debugState, setDebugState] = useState({\r\n    prefersDarkScheme: false,\r\n    prefersReducedMotion: false,\r\n  });\r\n  const { a11yPrefersState, setA11yPrefersState } = useUserPreferences();\r\n  const domStructureRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n    el.style.cssText = 'position:fixed;top:0;left:0;';\r\n    el.setAttribute('aria-hidden', 'true');\r\n    document.body.appendChild(el);\r\n    setDebugState({\r\n      prefersDarkScheme: a11yPrefersState.prefersDarkScheme,\r\n      prefersReducedMotion: a11yPrefersState.prefersReducedMotion,\r\n    });\r\n    const selectActiveEl = () => {\r\n      console.log('focused: ', document.activeElement);\r\n      let r3fa11ydebugidref = document.activeElement?.getAttribute(\r\n        'r3f-a11y-debug-id'\r\n      );\r\n      if (r3fa11ydebugidref) {\r\n        document.querySelectorAll('[r3fa11ydebugidref]').forEach(node => {\r\n          //@ts-ignore\r\n          node.style.color = null;\r\n        });\r\n        let refEl = document.querySelector(\r\n          '[r3fa11ydebugidref=\"' + r3fa11ydebugidref + '\"]'\r\n        );\r\n        if (refEl) {\r\n          //@ts-ignore\r\n          refEl.style.color = 'red';\r\n        }\r\n      }\r\n    };\r\n    console.log('enregistre ev');\r\n    document.addEventListener('focus', selectActiveEl, true);\r\n    let superinterval = window.setInterval(() => {\r\n      let r3fPosId = 0;\r\n      //@ts-ignore\r\n      let elements = [];\r\n      document.querySelectorAll('[r3f-a11y]').forEach(node => {\r\n        node.setAttribute('r3f-a11y-debug-id', '' + r3fPosId);\r\n        // let li = document.createElement('li');\r\n        // li.innerHTML = node.tagName ;\r\n        // //@ts-ignore\r\n        // domStructureRef.current.appendChild(li);\r\n        elements.push(\r\n          //@ts-ignore\r\n          <li key={r3fPosId} r3fa11ydebugidref={r3fPosId}>\r\n            {node.tagName}\r\n            <button\r\n              tabIndex={-1}\r\n              onClick={() => {\r\n                console.log(node);\r\n                let clientRect = node.getBoundingClientRect();\r\n                setBoundingStyle({\r\n                  width: clientRect.width,\r\n                  height: clientRect.height,\r\n                  top: clientRect.top,\r\n                  left: clientRect.left,\r\n                });\r\n              }}\r\n            >\r\n              Show\r\n            </button>\r\n          </li>\r\n        );\r\n        r3fPosId++;\r\n      });\r\n      //@ts-ignore\r\n      ReactDOM.render(<>{elements}</>, domStructureRef.current);\r\n    }, 2000);\r\n    return () => {\r\n      clearInterval(superinterval);\r\n      ReactDOM.unmountComponentAtNode(el);\r\n      console.log('remove ev');\r\n      document.removeEventListener('focus', selectActiveEl, true);\r\n    };\r\n  }, [a11yPrefersState]);\r\n\r\n  // @ts-ignore\r\n  const handleChange = e => {\r\n    // @ts-ignore\r\n    setA11yPrefersState({\r\n      prefersDarkScheme:\r\n        e.target.name === 'prefersDarkScheme'\r\n          ? e.target.checked\r\n          : debugState.prefersDarkScheme,\r\n      prefersReducedMotion:\r\n        e.target.name === 'prefersReducedMotion'\r\n          ? e.target.checked\r\n          : debugState.prefersReducedMotion,\r\n    });\r\n  };\r\n\r\n  useLayoutEffect(() => {\r\n    return void ReactDOM.render(\r\n      <>\r\n        <label>\r\n          Prefer dark mode\r\n          <input\r\n            type=\"checkbox\"\r\n            name=\"prefersDarkScheme\"\r\n            checked={debugState.prefersDarkScheme}\r\n            onChange={handleChange}\r\n          />\r\n        </label>\r\n        <label>\r\n          Prefer reduced motion\r\n          <input\r\n            type=\"checkbox\"\r\n            name=\"prefersReducedMotion\"\r\n            checked={debugState.prefersReducedMotion}\r\n            onChange={handleChange}\r\n          />\r\n        </label>\r\n        <h3>R3F Dom order</h3>\r\n        <ul ref={domStructureRef}></ul>\r\n        <div\r\n          style={Object.assign(\r\n            {\r\n              position: 'absolute' as const,\r\n              border: '1px solid white',\r\n              borderRadius: '50%',\r\n              background:\r\n                'linear-gradient( 45deg, rgb(70, 255, 60, 0.7), rgb(0, 64, 193, 0.7))',\r\n              pointerEvents: 'none' as const,\r\n              transition: 'all 200ms ease',\r\n            },\r\n            boundingStyle\r\n          )}\r\n        ></div>\r\n      </>,\r\n      el\r\n    );\r\n  });\r\n\r\n  return <></>;\r\n};\r\n"],"names":["useAnnounceStore","create","set","message","a11yScreenReader","A11ySectionContext","React","createContext","createRef","displayName","useA11ySectionContext","useContext","A11ySection","children","label","description","ref","useRef","refpDesc","gl","useThree","state","useState","document","createElement","el","target","domElement","parentNode","useEffect","setAttribute","current","pDesc","innerHTML","style","cssText","prepend","removeChild","appendChild","Provider","value","v1","Vector3","v2","v3","calculatePosition","camera","size","objectPos","setFromMatrixPosition","matrixWorld","project","widthHalf","width","heightHalf","height","x","y","isObjectBehindCamera","cameraPos","deltaCamObj","sub","camDir","getWorldDirection","angleTo","Math","PI","objectZIndex","zIndexRange","PerspectiveCamera","OrthographicCamera","dist","distanceTo","A","far","near","B","round","undefined","Html","eps","className","portal","props","scene","group","oldZoom","oldPosition","updateMatrixWorld","vec","ReactDOM","styles","position","transform","useFrame","abs","zoom","display","zIndex","A11yContext","focus","hover","pressed","useA11y","A11y","activationMsg","deactivationMsg","tabIndex","href","role","showAltText","actionCall","focusCall","disabled","debug","a11yElStyle","startPressed","hidden","constHiddenButScreenreadable","Object","assign","opacity","borderRadius","overflow","userSelect","WebkitUserSelect","WebkitTouchCallout","margin","hovered","focused","a11yState","setA11yState","overHtml","overMesh","componentIsMounted","cursor","Children","only","handleOnPointerOver","e","eventObject","handleOnPointerOut","handleBtnClick","window","setTimeout","handleToggleBtnClick","returnHtmlA11yEl","disabledBtnAttr","visibility","onPointerOver","onPointerOut","onClick","stopPropagation","onFocus","onBlur","preventDefault","tabIndexP","HtmlAccessibleElement","useMemo","AltText","maxWidth","top","left","background","padding","section","HTMLElement","A11yUserPreferencesContext","a11yPrefersState","prefersReducedMotion","prefersDarkScheme","setA11yPrefersState","_state","useUserPreferences","A11yUserPreferences","prefersReducedMotionMediaQuery","matchMedia","prefersDarkSchemeMediaQuery","matches","handleReducedMotionPrefChange","handleDarkSchemePrefChange","addEventListener","removeEventListener","offScreenStyle","border","clip","whiteSpace","A11yAnnouncer","mouseClickListener","activeElement","getAttribute","detail","blur","A11yDebuger","boundingStyle","setBoundingStyle","debugState","setDebugState","domStructureRef","body","selectActiveEl","console","log","r3fa11ydebugidref","querySelectorAll","forEach","node","color","refEl","querySelector","superinterval","setInterval","r3fPosId","elements","push","key","tagName","clientRect","getBoundingClientRect","clearInterval","handleChange","name","checked","useLayoutEffect","type","onChange","pointerEvents","transition"],"mappings":"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"}