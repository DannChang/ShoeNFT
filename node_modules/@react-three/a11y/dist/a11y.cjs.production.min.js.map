{"version":3,"file":"a11y.cjs.production.min.js","sources":["../src/announceStore.tsx","../src/A11ySection.tsx","../src/Html.tsx","../src/A11y.tsx","../src/A11yUserPreferences.tsx","../src/A11yAnnouncer.tsx","../src/A11yDebuger.tsx"],"sourcesContent":["import create from 'zustand';\r\n\r\ntype State = {\r\n  message: string;\r\n  a11yScreenReader: (message: string) => void;\r\n};\r\n\r\nconst useAnnounceStore = create<State>(set => {\r\n  return {\r\n    message: '',\r\n    a11yScreenReader: message => {\r\n      set(() => {\r\n        return { message: message };\r\n      });\r\n    },\r\n  };\r\n});\r\n\r\nexport default useAnnounceStore;\r\n","import React, {\r\n  useContext,\r\n  useEffect,\r\n  useRef,\r\n  MutableRefObject,\r\n  createRef,\r\n} from 'react';\r\nimport { useThree } from '@react-three/fiber';\r\n\r\ninterface Props {\r\n  children: React.ReactNode;\r\n  label: string;\r\n  description: string;\r\n}\r\n\r\nconst A11ySectionContext = React.createContext<\r\n  MutableRefObject<HTMLElement | null>\r\n>(createRef());\r\n\r\nA11ySectionContext.displayName = 'A11ySectionContext';\r\n\r\nconst useA11ySectionContext = () => {\r\n  return useContext(A11ySectionContext);\r\n};\r\n\r\nexport { useA11ySectionContext };\r\n\r\nexport const A11ySection: React.FC<Props> = ({\r\n  children,\r\n  label,\r\n  description,\r\n}) => {\r\n  const ref = useRef<HTMLElement | null>(null);\r\n  const refpDesc = useRef<HTMLParagraphElement | null>(null);\r\n  const gl = useThree(state => state.gl);\r\n  const [el] = React.useState(() => document.createElement('section'));\r\n  const target = gl.domElement.parentNode;\r\n\r\n  useEffect(() => {\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    if (label) {\r\n      el.setAttribute('aria-label', label);\r\n    }\r\n    el.setAttribute('r3f-a11y', 'true');\r\n    if (description) {\r\n      if (refpDesc.current === null) {\r\n        const pDesc = document.createElement('p');\r\n        pDesc.innerHTML = description;\r\n        pDesc.style.cssText =\r\n          'border: 0!important;clip: rect(1px,1px,1px,1px)!important;-webkit-clip-path: inset(50%)!important;clip-path: inset(50%)!important;height: 1px!important;margin: -1px!important;overflow: hidden!important;padding: 0!important;position: absolute!important;width: 1px!important;white-space: nowrap!important;';\r\n        el.prepend(pDesc);\r\n        refpDesc.current = pDesc;\r\n      } else {\r\n        refpDesc.current.innerHTML = description;\r\n      }\r\n    }\r\n    return () => {\r\n      if (target) target.removeChild(el);\r\n    };\r\n  }, [description, label]);\r\n\r\n  if (ref.current === null) {\r\n    if (target) {\r\n      target.appendChild(el);\r\n    }\r\n    ref.current = el;\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <A11ySectionContext.Provider value={ref}>\r\n        {children}\r\n      </A11ySectionContext.Provider>\r\n    </>\r\n  );\r\n};\r\n","//https://raw.githubusercontent.com/pmndrs/drei/master/src/web/Html.tsx\r\nimport * as React from 'react';\r\nimport * as ReactDOM from 'react-dom';\r\nimport {\r\n  Vector3,\r\n  Group,\r\n  Object3D,\r\n  Camera,\r\n  PerspectiveCamera,\r\n  OrthographicCamera,\r\n} from 'three';\r\nimport { Assign } from 'utility-types';\r\nimport { ReactThreeFiber, useFrame, useThree } from '@react-three/fiber';\r\n\r\nconst v1 = new Vector3();\r\nconst v2 = new Vector3();\r\nconst v3 = new Vector3();\r\n\r\nfunction calculatePosition(\r\n  el: Object3D,\r\n  camera: Camera,\r\n  size: { width: number; height: number }\r\n) {\r\n  const objectPos = v1.setFromMatrixPosition(el.matrixWorld);\r\n  objectPos.project(camera);\r\n  const widthHalf = size.width / 2;\r\n  const heightHalf = size.height / 2;\r\n  return [\r\n    objectPos.x * widthHalf + widthHalf,\r\n    -(objectPos.y * heightHalf) + heightHalf,\r\n  ];\r\n}\r\n\r\nfunction isObjectBehindCamera(el: Object3D, camera: Camera) {\r\n  const objectPos = v1.setFromMatrixPosition(el.matrixWorld);\r\n  const cameraPos = v2.setFromMatrixPosition(camera.matrixWorld);\r\n  const deltaCamObj = objectPos.sub(cameraPos);\r\n  const camDir = camera.getWorldDirection(v3);\r\n  return deltaCamObj.angleTo(camDir) > Math.PI / 2;\r\n}\r\n\r\nfunction objectZIndex(\r\n  el: Object3D,\r\n  camera: Camera,\r\n  zIndexRange: Array<number>\r\n) {\r\n  if (\r\n    camera instanceof PerspectiveCamera ||\r\n    camera instanceof OrthographicCamera\r\n  ) {\r\n    const objectPos = v1.setFromMatrixPosition(el.matrixWorld);\r\n    const cameraPos = v2.setFromMatrixPosition(camera.matrixWorld);\r\n    const dist = objectPos.distanceTo(cameraPos);\r\n    const A = (zIndexRange[1] - zIndexRange[0]) / (camera.far - camera.near);\r\n    const B = zIndexRange[1] - A * camera.far;\r\n    return Math.round(A * dist + B);\r\n  }\r\n  return undefined;\r\n}\r\n\r\nexport interface HtmlProps\r\n  extends Omit<\r\n    Assign<\r\n      React.HTMLAttributes<HTMLDivElement>,\r\n      ReactThreeFiber.Object3DNode<Group, typeof Group>\r\n    >,\r\n    'ref'\r\n  > {\r\n  eps?: number;\r\n  portal?: React.MutableRefObject<HTMLElement>;\r\n  zIndexRange?: Array<number>;\r\n}\r\n\r\nexport const Html = React.forwardRef(\r\n  (\r\n    {\r\n      children,\r\n      eps = 0.001,\r\n      style,\r\n      className,\r\n      portal,\r\n      zIndexRange = [16777271, 0],\r\n      ...props\r\n    }: HtmlProps,\r\n    ref: React.Ref<HTMLDivElement>\r\n  ) => {\r\n    const gl = useThree(({ gl }) => gl);\r\n    const camera = useThree(({ camera }) => camera);\r\n    const scene = useThree(({ scene }) => scene);\r\n    const size = useThree(({ size }) => size);\r\n    const [el] = React.useState(() => document.createElement('div'));\r\n    const group = React.useRef<Group>(null);\r\n    const oldZoom = React.useRef(0);\r\n    const oldPosition = React.useRef([0, 0]);\r\n    const target = portal?.current ?? gl.domElement.parentNode;\r\n\r\n    React.useEffect(() => {\r\n      if (group.current) {\r\n        scene.updateMatrixWorld();\r\n        const vec = calculatePosition(group.current, camera, size);\r\n        el.style.cssText = `position:absolute;top:0;left:0;transform:translate3d(${vec[0]}px,${vec[1]}px,0);transform-origin:0 0;`;\r\n        if (target) {\r\n          target.appendChild(el);\r\n        }\r\n        return () => {\r\n          if (target) target.removeChild(el);\r\n          ReactDOM.unmountComponentAtNode(el);\r\n        };\r\n      }\r\n      // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [target]);\r\n\r\n    const styles: React.CSSProperties = React.useMemo(() => {\r\n      return {\r\n        position: 'absolute',\r\n        transform: 'none',\r\n        ...style,\r\n      };\r\n    }, [style, size]);\r\n\r\n    React.useLayoutEffect(() => {\r\n      ReactDOM.render(\r\n        <div\r\n          ref={ref}\r\n          style={styles}\r\n          className={className}\r\n          children={children}\r\n        />,\r\n        el\r\n      );\r\n    });\r\n\r\n    useFrame(() => {\r\n      if (group.current) {\r\n        camera.updateMatrixWorld();\r\n        const vec = calculatePosition(group.current, camera, size);\r\n\r\n        if (\r\n          Math.abs(oldZoom.current - camera.zoom) > eps ||\r\n          Math.abs(oldPosition.current[0] - vec[0]) > eps ||\r\n          Math.abs(oldPosition.current[1] - vec[1]) > eps\r\n        ) {\r\n          el.style.display = !isObjectBehindCamera(group.current, camera)\r\n            ? 'block'\r\n            : 'none';\r\n          el.style.zIndex = `${objectZIndex(\r\n            group.current,\r\n            camera,\r\n            zIndexRange\r\n          )}`;\r\n          el.style.transform = `translate3d(${vec[0]}px,${vec[1]}px,0) scale(1)`;\r\n          oldPosition.current = vec;\r\n          oldZoom.current = camera.zoom;\r\n        }\r\n      }\r\n    });\r\n\r\n    return <group {...props} ref={group} />;\r\n  }\r\n);\r\n","import React, { useEffect, useRef, useState, useContext } from 'react';\r\nimport { useThree } from '@react-three/fiber';\r\nimport useAnnounceStore from './announceStore';\r\nimport { useA11ySectionContext } from './A11ySection';\r\nimport { Html } from './Html';\r\n\r\ninterface A11yCommonProps {\r\n  role: 'button' | 'togglebutton' | 'link' | 'content';\r\n  children: React.ReactNode;\r\n  description: string;\r\n  tabIndex?: number;\r\n  showAltText?: boolean;\r\n  focusCall?: (...args: any[]) => any;\r\n  debug?: boolean;\r\n  a11yElStyle?: Object;\r\n  hidden?: boolean;\r\n}\r\n\r\ntype RoleProps =\r\n  | {\r\n      role: 'content';\r\n      activationMsg?: never;\r\n      deactivationMsg?: never;\r\n      actionCall?: never;\r\n      href?: never;\r\n      disabled?: never;\r\n      startPressed?: never;\r\n    }\r\n  | {\r\n      role: 'button';\r\n      activationMsg?: string;\r\n      deactivationMsg?: never;\r\n      actionCall?: () => any;\r\n      href?: never;\r\n      disabled?: boolean;\r\n      startPressed?: never;\r\n    }\r\n  | {\r\n      role: 'togglebutton';\r\n      activationMsg?: string;\r\n      deactivationMsg?: string;\r\n      actionCall?: () => any;\r\n      href?: never;\r\n      disabled?: boolean;\r\n      startPressed?: boolean;\r\n    }\r\n  | {\r\n      role: 'link';\r\n      activationMsg?: never;\r\n      deactivationMsg?: never;\r\n      actionCall: () => any;\r\n      href: string;\r\n      disabled?: never;\r\n      startPressed?: never;\r\n    };\r\n\r\ntype Props = A11yCommonProps & RoleProps;\r\n\r\nconst A11yContext = React.createContext({\r\n  focus: false,\r\n  hover: false,\r\n  pressed: false,\r\n});\r\n\r\nA11yContext.displayName = 'A11yContext';\r\n\r\nconst useA11y = () => {\r\n  return useContext(A11yContext);\r\n};\r\n\r\nexport { useA11y };\r\n\r\nexport const A11y: React.FC<Props> = ({\r\n  children,\r\n  description,\r\n  activationMsg,\r\n  deactivationMsg,\r\n  tabIndex,\r\n  href,\r\n  role,\r\n  showAltText = false,\r\n  actionCall,\r\n  focusCall,\r\n  disabled,\r\n  debug = false,\r\n  a11yElStyle,\r\n  startPressed = false,\r\n  hidden = false,\r\n  ...props\r\n}) => {\r\n  let constHiddenButScreenreadable = Object.assign(\r\n    {\r\n      opacity: debug ? 1 : 0,\r\n      borderRadius: '50%',\r\n      width: '50px',\r\n      height: '50px',\r\n      overflow: 'hidden',\r\n      transform: 'translateX(-50%) translateY(-50%)',\r\n      display: 'inline-block',\r\n      userSelect: 'none' as const,\r\n      WebkitUserSelect: 'none' as const,\r\n      WebkitTouchCallout: 'none' as const,\r\n      margin: 0,\r\n    },\r\n    a11yElStyle\r\n  );\r\n\r\n  const [a11yState, setA11yState] = useState({\r\n    hovered: false,\r\n    focused: false,\r\n    pressed: startPressed ? startPressed : false,\r\n  });\r\n\r\n  const a11yScreenReader = useAnnounceStore(state => state.a11yScreenReader);\r\n\r\n  const overHtml = useRef(false);\r\n  const overMesh = useRef(false);\r\n\r\n  const domElement = useThree(state => state.gl.domElement);\r\n\r\n  // temporary fix to prevent error -> keep track of our component's mounted state\r\n  const componentIsMounted = useRef(true);\r\n  useEffect(() => {\r\n    return () => {\r\n      domElement.style.cursor = 'default';\r\n      componentIsMounted.current = false;\r\n    };\r\n  }, []); // Using an empty dependency array ensures this on\r\n\r\n  React.Children.only(children);\r\n  // @ts-ignore\r\n  const handleOnPointerOver = e => {\r\n    if (e.eventObject) {\r\n      overMesh.current = true;\r\n    } else {\r\n      overHtml.current = true;\r\n    }\r\n    if (overHtml.current || overMesh.current) {\r\n      if (role !== 'content' && !disabled) {\r\n        domElement.style.cursor = 'pointer';\r\n      }\r\n      setA11yState({\r\n        hovered: true,\r\n        focused: a11yState.focused,\r\n        pressed: a11yState.pressed,\r\n      });\r\n    }\r\n  };\r\n  // @ts-ignore\r\n  const handleOnPointerOut = e => {\r\n    if (e.eventObject) {\r\n      overMesh.current = false;\r\n    } else {\r\n      overHtml.current = false;\r\n    }\r\n    if (!overHtml.current && !overMesh.current) {\r\n      if (componentIsMounted.current) {\r\n        domElement.style.cursor = 'default';\r\n        setA11yState({\r\n          hovered: false,\r\n          focused: a11yState.focused,\r\n          pressed: a11yState.pressed,\r\n        });\r\n      }\r\n    }\r\n  };\r\n\r\n  function handleBtnClick() {\r\n    //msg is the same need to be clean for it to trigger again in case of multiple press in a row\r\n    a11yScreenReader('');\r\n    window.setTimeout(() => {\r\n      if (typeof activationMsg === 'string') a11yScreenReader(activationMsg);\r\n    }, 100);\r\n    if (typeof actionCall === 'function') actionCall();\r\n  }\r\n\r\n  function handleToggleBtnClick() {\r\n    if (a11yState.pressed) {\r\n      if (typeof deactivationMsg === 'string')\r\n        a11yScreenReader(deactivationMsg);\r\n    } else {\r\n      if (typeof activationMsg === 'string') a11yScreenReader(activationMsg);\r\n    }\r\n    setA11yState({\r\n      hovered: a11yState.hovered,\r\n      focused: a11yState.focused,\r\n      pressed: !a11yState.pressed,\r\n    });\r\n    if (typeof actionCall === 'function') actionCall();\r\n  }\r\n\r\n  const returnHtmlA11yEl = () => {\r\n    if (role === 'button' || role === 'togglebutton') {\r\n      let disabledBtnAttr = disabled\r\n        ? {\r\n            disabled: true,\r\n          }\r\n        : null;\r\n      if (role === 'togglebutton') {\r\n        return (\r\n          <button\r\n            r3f-a11y=\"true\"\r\n            {...disabledBtnAttr}\r\n            aria-pressed={a11yState.pressed ? 'true' : 'false'}\r\n            tabIndex={tabIndex ? tabIndex : 0}\r\n            style={Object.assign(\r\n              constHiddenButScreenreadable,\r\n              disabled ? { cursor: 'default' } : { cursor: 'pointer' },\r\n              hidden\r\n                ? { visibility: 'hidden' as const }\r\n                : { visibility: 'visible' as const }\r\n            )}\r\n            onPointerOver={handleOnPointerOver}\r\n            onPointerOut={handleOnPointerOut}\r\n            onClick={e => {\r\n              e.stopPropagation();\r\n              if (disabled) {\r\n                return;\r\n              }\r\n              handleToggleBtnClick();\r\n            }}\r\n            onFocus={() => {\r\n              if (typeof focusCall === 'function') focusCall();\r\n              setA11yState({\r\n                hovered: a11yState.hovered,\r\n                focused: true,\r\n                pressed: a11yState.pressed,\r\n              });\r\n            }}\r\n            onBlur={() => {\r\n              setA11yState({\r\n                hovered: a11yState.hovered,\r\n                focused: false,\r\n                pressed: a11yState.pressed,\r\n              });\r\n            }}\r\n          >\r\n            {description}\r\n          </button>\r\n        );\r\n      } else {\r\n        //regular btn\r\n        return (\r\n          <button\r\n            r3f-a11y=\"true\"\r\n            {...disabledBtnAttr}\r\n            tabIndex={tabIndex ? tabIndex : 0}\r\n            style={Object.assign(\r\n              constHiddenButScreenreadable,\r\n              disabled ? { cursor: 'default' } : { cursor: 'pointer' },\r\n              hidden\r\n                ? { visibility: 'hidden' as const }\r\n                : { visibility: 'visible' as const }\r\n            )}\r\n            onPointerOver={handleOnPointerOver}\r\n            onPointerOut={handleOnPointerOut}\r\n            onClick={e => {\r\n              e.stopPropagation();\r\n              if (disabled) {\r\n                return;\r\n              }\r\n              handleBtnClick();\r\n            }}\r\n            onFocus={() => {\r\n              if (typeof focusCall === 'function') focusCall();\r\n              setA11yState({\r\n                hovered: a11yState.hovered,\r\n                focused: true,\r\n                pressed: a11yState.pressed,\r\n              });\r\n            }}\r\n            onBlur={() => {\r\n              setA11yState({\r\n                hovered: a11yState.hovered,\r\n                focused: false,\r\n                pressed: a11yState.pressed,\r\n              });\r\n            }}\r\n          >\r\n            {description}\r\n          </button>\r\n        );\r\n      }\r\n    } else if (role === 'link') {\r\n      return (\r\n        <a\r\n          r3f-a11y=\"true\"\r\n          style={Object.assign(\r\n            constHiddenButScreenreadable,\r\n            hidden\r\n              ? { visibility: 'hidden' as const }\r\n              : { visibility: 'visible' as const }\r\n          )}\r\n          href={href}\r\n          onPointerOver={handleOnPointerOver}\r\n          onPointerOut={handleOnPointerOut}\r\n          onClick={e => {\r\n            e.stopPropagation();\r\n            e.preventDefault();\r\n            if (typeof actionCall === 'function') actionCall();\r\n          }}\r\n          onFocus={() => {\r\n            if (typeof focusCall === 'function') focusCall();\r\n            setA11yState({\r\n              hovered: a11yState.hovered,\r\n              focused: true,\r\n              pressed: a11yState.pressed,\r\n            });\r\n          }}\r\n          onBlur={() => {\r\n            setA11yState({\r\n              hovered: a11yState.hovered,\r\n              focused: false,\r\n              pressed: a11yState.pressed,\r\n            });\r\n          }}\r\n        >\r\n          {description}\r\n        </a>\r\n      );\r\n    } else {\r\n      let tabIndexP = tabIndex\r\n        ? {\r\n            tabIndex: tabIndex,\r\n          }\r\n        : null;\r\n      return (\r\n        <p\r\n          r3f-a11y=\"true\"\r\n          {...tabIndexP}\r\n          style={Object.assign(\r\n            constHiddenButScreenreadable,\r\n            hidden\r\n              ? { visibility: 'hidden' as const }\r\n              : { visibility: 'visible' as const }\r\n          )}\r\n          onPointerOver={handleOnPointerOver}\r\n          onPointerOut={handleOnPointerOut}\r\n          onBlur={() => {\r\n            setA11yState({\r\n              hovered: a11yState.hovered,\r\n              focused: false,\r\n              pressed: a11yState.pressed,\r\n            });\r\n          }}\r\n          onFocus={() => {\r\n            if (typeof focusCall === 'function') focusCall();\r\n            setA11yState({\r\n              hovered: a11yState.hovered,\r\n              focused: true,\r\n              pressed: a11yState.pressed,\r\n            });\r\n          }}\r\n        >\r\n          {description}\r\n        </p>\r\n      );\r\n    }\r\n  };\r\n\r\n  const HtmlAccessibleElement = React.useMemo(returnHtmlA11yEl, [\r\n    description,\r\n    a11yState,\r\n    hidden,\r\n    tabIndex,\r\n    href,\r\n    disabled,\r\n    startPressed,\r\n    actionCall,\r\n    focusCall,\r\n  ]);\r\n\r\n  let AltText = null;\r\n  if (showAltText && a11yState.hovered) {\r\n    AltText = (\r\n      <div\r\n        aria-hidden={true}\r\n        style={{\r\n          width: 'auto',\r\n          maxWidth: '300px',\r\n          display: 'block',\r\n          position: 'absolute',\r\n          top: '0px',\r\n          left: '0px',\r\n          transform: 'translate(-50%,-50%)',\r\n          background: 'white',\r\n          borderRadius: '4px',\r\n          padding: '4px',\r\n        }}\r\n      >\r\n        <p\r\n          aria-hidden={true}\r\n          style={{\r\n            margin: '0px',\r\n          }}\r\n        >\r\n          {description}\r\n        </p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const section = useA11ySectionContext();\r\n  let portal = {};\r\n  if (section instanceof HTMLElement) {\r\n    portal = { portal: section };\r\n  }\r\n\r\n  return (\r\n    <A11yContext.Provider\r\n      value={{\r\n        hover: a11yState.hovered,\r\n        focus: a11yState.focused,\r\n        pressed: a11yState.pressed,\r\n      }}\r\n    >\r\n      <group\r\n        {...props}\r\n        onClick={e => {\r\n          e.stopPropagation();\r\n          if (disabled) {\r\n            return;\r\n          }\r\n          if (role === 'button') {\r\n            handleBtnClick();\r\n          } else if (role === 'togglebutton') {\r\n            handleToggleBtnClick();\r\n          } else {\r\n            if (typeof actionCall === 'function') actionCall();\r\n          }\r\n        }}\r\n        onPointerOver={handleOnPointerOver}\r\n        onPointerOut={handleOnPointerOut}\r\n      >\r\n        {children}\r\n        <Html\r\n          style={{ width: '0px' }}\r\n          position={\r\n            // @ts-ignore\r\n            children.props.position ? children.props.position : 0\r\n          }\r\n          {...portal}\r\n        >\r\n          {AltText}\r\n          {HtmlAccessibleElement}\r\n        </Html>\r\n      </group>\r\n    </A11yContext.Provider>\r\n  );\r\n};\r\n","import React, { useEffect, useState, useContext } from 'react';\r\ninterface Props {\r\n  children: React.ReactNode;\r\n}\r\n\r\ntype aasetA11yPrefersState = {\r\n  prefersReducedMotion: boolean;\r\n  prefersDarkScheme: boolean;\r\n};\r\n\r\nconst A11yUserPreferencesContext = React.createContext({\r\n  a11yPrefersState: {\r\n    prefersReducedMotion: false,\r\n    prefersDarkScheme: false,\r\n  },\r\n  // tslint:disable:no-unused-variable\r\n  setA11yPrefersState: (_state: aasetA11yPrefersState) => {},\r\n  // tslint:enable:no-unused-variable\r\n});\r\n\r\nA11yUserPreferencesContext.displayName = 'A11yUserPreferencesContext';\r\n\r\nconst useUserPreferences = () => {\r\n  return useContext(A11yUserPreferencesContext);\r\n};\r\n\r\nexport { useUserPreferences, A11yUserPreferencesContext };\r\n\r\nexport const A11yUserPreferences: React.FC<Props> = ({ children }) => {\r\n  const [a11yPrefersState, setA11yPrefersState] = useState({\r\n    prefersReducedMotion: false,\r\n    prefersDarkScheme: false,\r\n  });\r\n\r\n  useEffect(() => {\r\n    const prefersReducedMotionMediaQuery = window.matchMedia(\r\n      '(prefers-reduced-motion: reduce)'\r\n    );\r\n    const prefersDarkSchemeMediaQuery = window.matchMedia(\r\n      '(prefers-color-scheme: dark)'\r\n    );\r\n\r\n    setA11yPrefersState({\r\n      prefersReducedMotion: prefersReducedMotionMediaQuery.matches,\r\n      prefersDarkScheme: prefersDarkSchemeMediaQuery.matches,\r\n    });\r\n\r\n    const handleReducedMotionPrefChange = (e: MediaQueryListEvent) => {\r\n      setA11yPrefersState({\r\n        prefersReducedMotion: e.matches,\r\n        prefersDarkScheme: prefersDarkSchemeMediaQuery.matches,\r\n      });\r\n    };\r\n    const handleDarkSchemePrefChange = (e: MediaQueryListEvent) => {\r\n      setA11yPrefersState({\r\n        prefersReducedMotion: prefersReducedMotionMediaQuery.matches,\r\n        prefersDarkScheme: e.matches,\r\n      });\r\n    };\r\n\r\n    prefersReducedMotionMediaQuery.addEventListener(\r\n      'change',\r\n      handleReducedMotionPrefChange\r\n    );\r\n    prefersDarkSchemeMediaQuery.addEventListener(\r\n      'change',\r\n      handleDarkSchemePrefChange\r\n    );\r\n    return () => {\r\n      prefersReducedMotionMediaQuery.removeEventListener(\r\n        'change',\r\n        handleReducedMotionPrefChange\r\n      );\r\n      prefersDarkSchemeMediaQuery.removeEventListener(\r\n        'change',\r\n        handleDarkSchemePrefChange\r\n      );\r\n    };\r\n  }, []);\r\n\r\n  return (\r\n    <A11yUserPreferencesContext.Provider\r\n      value={{\r\n        a11yPrefersState: {\r\n          prefersReducedMotion: a11yPrefersState.prefersReducedMotion,\r\n          prefersDarkScheme: a11yPrefersState.prefersDarkScheme,\r\n        },\r\n        setA11yPrefersState: setA11yPrefersState,\r\n      }}\r\n    >\r\n      {children}\r\n    </A11yUserPreferencesContext.Provider>\r\n  );\r\n};\r\n","import React, { useEffect } from 'react';\r\nimport useAnnounceStore from './announceStore';\r\n\r\nconst offScreenStyle = {\r\n  border: 0,\r\n  clip: 'rect(0 0 0 0)',\r\n  height: '1px',\r\n  margin: '-1px',\r\n  overflow: 'hidden',\r\n  whiteSpace: 'nowrap' as const,\r\n  padding: 0,\r\n  width: '1px',\r\n  position: 'absolute' as const,\r\n};\r\n\r\nexport const A11yAnnouncer: React.FC = () => {\r\n  const message = useAnnounceStore(state => state.message);\r\n\r\n  useEffect(() => {\r\n    const mouseClickListener = (e: MouseEvent) => {\r\n      if (\r\n        window.document.activeElement?.getAttribute('r3f-a11y') &&\r\n        e.detail !== 0\r\n      ) {\r\n        if (window.document.activeElement instanceof HTMLElement) {\r\n          window.document.activeElement.blur();\r\n        }\r\n      }\r\n    };\r\n    window.addEventListener('click', mouseClickListener);\r\n    return () => {\r\n      window.removeEventListener('click', mouseClickListener);\r\n    };\r\n  });\r\n\r\n  return (\r\n    <div style={offScreenStyle} aria-atomic=\"true\" aria-live=\"polite\">\r\n      {message}\r\n    </div>\r\n  );\r\n};\r\n","import React, { useLayoutEffect, useEffect, useState, useRef } from 'react';\r\nimport * as ReactDOM from 'react-dom';\r\nimport { useUserPreferences } from './A11yUserPreferences';\r\ninterface Props {}\r\n\r\nexport const A11yDebuger: React.FC<Props> = ({}) => {\r\n  const [el] = useState(() => document.createElement('div'));\r\n  const [boundingStyle, setBoundingStyle] = useState({});\r\n  const [debugState, setDebugState] = useState({\r\n    prefersDarkScheme: false,\r\n    prefersReducedMotion: false,\r\n  });\r\n  const { a11yPrefersState, setA11yPrefersState } = useUserPreferences();\r\n  const domStructureRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n    el.style.cssText = 'position:fixed;top:0;left:0;';\r\n    el.setAttribute('aria-hidden', 'true');\r\n    document.body.appendChild(el);\r\n    setDebugState({\r\n      prefersDarkScheme: a11yPrefersState.prefersDarkScheme,\r\n      prefersReducedMotion: a11yPrefersState.prefersReducedMotion,\r\n    });\r\n    const selectActiveEl = () => {\r\n      console.log('focused: ', document.activeElement);\r\n      let r3fa11ydebugidref = document.activeElement?.getAttribute(\r\n        'r3f-a11y-debug-id'\r\n      );\r\n      if (r3fa11ydebugidref) {\r\n        document.querySelectorAll('[r3fa11ydebugidref]').forEach(node => {\r\n          //@ts-ignore\r\n          node.style.color = null;\r\n        });\r\n        let refEl = document.querySelector(\r\n          '[r3fa11ydebugidref=\"' + r3fa11ydebugidref + '\"]'\r\n        );\r\n        if (refEl) {\r\n          //@ts-ignore\r\n          refEl.style.color = 'red';\r\n        }\r\n      }\r\n    };\r\n    console.log('enregistre ev');\r\n    document.addEventListener('focus', selectActiveEl, true);\r\n    let superinterval = window.setInterval(() => {\r\n      let r3fPosId = 0;\r\n      //@ts-ignore\r\n      let elements = [];\r\n      document.querySelectorAll('[r3f-a11y]').forEach(node => {\r\n        node.setAttribute('r3f-a11y-debug-id', '' + r3fPosId);\r\n        // let li = document.createElement('li');\r\n        // li.innerHTML = node.tagName ;\r\n        // //@ts-ignore\r\n        // domStructureRef.current.appendChild(li);\r\n        elements.push(\r\n          //@ts-ignore\r\n          <li key={r3fPosId} r3fa11ydebugidref={r3fPosId}>\r\n            {node.tagName}\r\n            <button\r\n              tabIndex={-1}\r\n              onClick={() => {\r\n                console.log(node);\r\n                let clientRect = node.getBoundingClientRect();\r\n                setBoundingStyle({\r\n                  width: clientRect.width,\r\n                  height: clientRect.height,\r\n                  top: clientRect.top,\r\n                  left: clientRect.left,\r\n                });\r\n              }}\r\n            >\r\n              Show\r\n            </button>\r\n          </li>\r\n        );\r\n        r3fPosId++;\r\n      });\r\n      //@ts-ignore\r\n      ReactDOM.render(<>{elements}</>, domStructureRef.current);\r\n    }, 2000);\r\n    return () => {\r\n      clearInterval(superinterval);\r\n      ReactDOM.unmountComponentAtNode(el);\r\n      console.log('remove ev');\r\n      document.removeEventListener('focus', selectActiveEl, true);\r\n    };\r\n  }, [a11yPrefersState]);\r\n\r\n  // @ts-ignore\r\n  const handleChange = e => {\r\n    // @ts-ignore\r\n    setA11yPrefersState({\r\n      prefersDarkScheme:\r\n        e.target.name === 'prefersDarkScheme'\r\n          ? e.target.checked\r\n          : debugState.prefersDarkScheme,\r\n      prefersReducedMotion:\r\n        e.target.name === 'prefersReducedMotion'\r\n          ? e.target.checked\r\n          : debugState.prefersReducedMotion,\r\n    });\r\n  };\r\n\r\n  useLayoutEffect(() => {\r\n    return void ReactDOM.render(\r\n      <>\r\n        <label>\r\n          Prefer dark mode\r\n          <input\r\n            type=\"checkbox\"\r\n            name=\"prefersDarkScheme\"\r\n            checked={debugState.prefersDarkScheme}\r\n            onChange={handleChange}\r\n          />\r\n        </label>\r\n        <label>\r\n          Prefer reduced motion\r\n          <input\r\n            type=\"checkbox\"\r\n            name=\"prefersReducedMotion\"\r\n            checked={debugState.prefersReducedMotion}\r\n            onChange={handleChange}\r\n          />\r\n        </label>\r\n        <h3>R3F Dom order</h3>\r\n        <ul ref={domStructureRef}></ul>\r\n        <div\r\n          style={Object.assign(\r\n            {\r\n              position: 'absolute' as const,\r\n              border: '1px solid white',\r\n              borderRadius: '50%',\r\n              background:\r\n                'linear-gradient( 45deg, rgb(70, 255, 60, 0.7), rgb(0, 64, 193, 0.7))',\r\n              pointerEvents: 'none' as const,\r\n              transition: 'all 200ms ease',\r\n            },\r\n            boundingStyle\r\n          )}\r\n        ></div>\r\n      </>,\r\n      el\r\n    );\r\n  });\r\n\r\n  return <></>;\r\n};\r\n"],"names":["useAnnounceStore","create","set","message","a11yScreenReader","A11ySectionContext","React","createContext","createRef","displayName","v1","Vector3","v2","v3","calculatePosition","el","camera","size","objectPos","setFromMatrixPosition","matrixWorld","project","widthHalf","width","heightHalf","height","x","y","Html","ref","children","eps","style","className","portal","zIndexRange","props","gl","useThree","scene","document","createElement","group","oldZoom","oldPosition","target","current","domElement","parentNode","updateMatrixWorld","vec","cssText","appendChild","removeChild","ReactDOM","styles","position","transform","useFrame","Math","abs","zoom","display","cameraPos","deltaCamObj","sub","camDir","getWorldDirection","angleTo","PI","isObjectBehindCamera","zIndex","PerspectiveCamera","OrthographicCamera","dist","distanceTo","A","far","near","round","objectZIndex","A11yContext","focus","hover","pressed","A11yUserPreferencesContext","a11yPrefersState","prefersReducedMotion","prefersDarkScheme","setA11yPrefersState","_state","useUserPreferences","useContext","offScreenStyle","border","clip","margin","overflow","whiteSpace","padding","description","activationMsg","deactivationMsg","tabIndex","href","role","showAltText","actionCall","focusCall","disabled","debug","a11yElStyle","startPressed","hidden","constHiddenButScreenreadable","Object","assign","opacity","borderRadius","userSelect","WebkitUserSelect","WebkitTouchCallout","useState","hovered","focused","a11yState","setA11yState","state","overHtml","useRef","overMesh","componentIsMounted","useEffect","cursor","Children","only","handleOnPointerOver","e","eventObject","handleOnPointerOut","handleBtnClick","window","setTimeout","handleToggleBtnClick","HtmlAccessibleElement","useMemo","visibility","onPointerOver","onPointerOut","onClick","stopPropagation","onFocus","onBlur","preventDefault","AltText","maxWidth","top","left","background","section","HTMLElement","Provider","value","mouseClickListener","activeElement","getAttribute","detail","blur","addEventListener","removeEventListener","boundingStyle","setBoundingStyle","debugState","setDebugState","domStructureRef","setAttribute","body","selectActiveEl","console","log","r3fa11ydebugidref","_document$activeEleme","querySelectorAll","forEach","node","color","refEl","querySelector","superinterval","setInterval","r3fPosId","elements","push","key","tagName","clientRect","getBoundingClientRect","clearInterval","handleChange","name","checked","useLayoutEffect","type","onChange","pointerEvents","transition","label","refpDesc","pDesc","innerHTML","prepend","prefersReducedMotionMediaQuery","matchMedia","prefersDarkSchemeMediaQuery","matches","handleReducedMotionPrefChange","handleDarkSchemePrefChange"],"mappings":"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"}